import json

# === CONFIGURATION ===
db_source = "ESOM_GGN"
input_prefix_base = "somggn_raw.db/"
output_prefix_base = "somggn_dq.db/"
load_type = "full_load"

# === INPUT FILE ===
# The file should contain one table name per line, e.g.:
# WORK_ORDER_DOCUMENTS
# SHIFT_STAFFING
# LOG_ENTRY_DOCUMENTS
input_file = "table_names.txt"

# === OUTPUT FILE ===
output_file = "table_records.json"

# === MAIN LOGIC ===
def generate_records():
    with open(input_file, "r") as f:
        table_names = [line.strip() for line in f if line.strip()]

    records = []
    for table in table_names:
        record = {
            "db_source": db_source,
            "table_name": table,
            "input_prefix": f"{input_prefix_base}{table.lower()}/",
            "output_prefix": f"{output_prefix_base}{table.lower()}/",
            "load_type": load_type,
            "last_full_load_date": None,
            "last_cdc_load_date": None,
            "pk_fields": None
        }
        records.append(record)

    # Write to JSON file
    with open(output_file, "w") as f:
        json.dump(records, f, indent=4)

    print(f"âœ… Generated {len(records)} records and saved to '{output_file}'")

if __name__ == "__main__":
    generate_records()
